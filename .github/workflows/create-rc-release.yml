name: Get Latest SAPIG RC Build Version
#run-name: "${{ inputs.releaseVersion }}: RC Build"
on:
  workflow_dispatch:
    inputs:
      buildVersion:
        description: What version of SAPIG is being built (#.#.# - rc# not required)
        type: string
        required: true
#      draftBuild:
#        description: Is this a draft build (No artifacts pushed)
#        type: boolean
#        required: true
      sapigType:
        description: SAPIG Type to be built (ob | core)
        type: string
        required: true
jobs:
  build:
    name: Build
    runs-on: ubuntu-latest
    steps:
      # Prepare Environment
      - name: Prepare Environment
        run: |
          sapigType=$(echo "${{ inputs.sapigType }}" | tr "[:upper:]" "[:lower:]")
          if [ "$sapigType" != "core" ] && [ "$sapigType" != "ob" ]; then
            echo "Warning: sapigType can only be 'ob' or 'core'"
            exit 1
          fi
          if [ "$sapigType" == "core" ]; then
            echo "Core Components to be built; Core"
            components="Core"
          else
            echo "OB Components to be built; IG, RCS, RS, RCS-UI, Test Data Initializer, Functional Tests & DCR Conformance Tests"
            components="IG RCS RS RCSUI TDI FUNC DCR"
          fi
          versionToUse=$(./scripts/docker-get-max-rc-version.sh "$components" "$version")
          echo "Use `${{ inputs.releaseVersion }}-rc$versionToUse` in the release workflows"